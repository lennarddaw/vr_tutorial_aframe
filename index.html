<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VR CodeLab - Interaktives Programmieren Lernen</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- A-Frame VR Framework -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <!-- Erweiterte Komponenten für bessere Interaktivität -->
    <script src="https://cdn.jsdelivr.net/gh/supermedium/superframe@master/components/event-set/dist/aframe-event-set-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/supermedium/superframe@master/components/animation/dist/aframe-animation-component.min.js"></script>
    
    <!-- Externes CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-content">
            <div class="logo">
                <h1>VR CodeLab</h1>
                <div class="loading-animation">
                    <div class="code-symbol"></div>
                    <div class="code-symbol"></div>
                    <div class="code-symbol"></div>
                </div>
            </div>
            <p>Lade Programmier-Umgebung...</p>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>
    </div>

    <!-- UI Overlay -->
    <div id="ui-overlay">
        <!-- Header -->
        <header class="top-bar">
            <div class="left-section">
                <h1 class="app-title">
                    <i data-lucide="rocket" class="icon"></i>
                    VR CodeLab
                </h1>
                <div class="level-indicator">
                    <span class="level-label">Level</span>
                    <span id="current-level">1</span>
                    <span class="level-total">/ 5</span>
                </div>
            </div>
            
            <div class="right-section">
                <div class="score-display">
                    <i data-lucide="trophy" class="icon"></i>
                    <span id="score">0</span>
                    <span class="score-label">Punkte</span>
                </div>
                <button id="help-btn" class="icon-btn" title="Hilfe">
                    <i data-lucide="help-circle"></i>
                </button>
                <button id="settings-btn" class="icon-btn" title="Einstellungen">
                    <i data-lucide="settings"></i>
                </button>
            </div>
        </header>

        <!-- Task Panel -->
        <div id="task-panel" class="panel">
            <h3>
                <i data-lucide="target"></i>
                Deine Aufgabe
            </h3>
            <div id="task-description">
                Willkommen! Erstelle dein erstes Programm, indem du Code-Blöcke kombinierst.
            </div>
            <div class="task-progress">
                <div class="progress-steps">
                    <span class="step active">1</span>
                    <span class="step">2</span>
                    <span class="step">3</span>
                    <span class="step">4</span>
                    <span class="step">5</span>
                </div>
            </div>
        </div>

        <!-- Code Output Panel -->
        <div id="code-panel" class="panel">
            <h3>
                <i data-lucide="code-2"></i>
                Dein Code
            </h3>
            <div id="code-output" class="code-display">
                <div class="code-line">// Dein Programm wird hier angezeigt</div>
            </div>
            <div class="panel-actions">
                <button id="run-code-btn" class="action-btn primary">
                    <i data-lucide="play"></i>
                    Code ausführen
                </button>
                <button id="reset-code-btn" class="action-btn secondary">
                    <i data-lucide="rotate-ccw"></i>
                    Zurücksetzen
                </button>
            </div>
        </div>

        <!-- Instructions Panel -->
        <div id="instructions-panel" class="panel collapsed">
            <h3>
                <i data-lucide="book-open"></i>
                Anleitung
            </h3>
            <div class="instruction-content">
                <div class="control-info">
                    <h4>Steuerung:</h4>
                    <ul>
                        <li><strong>VR:</strong> Controller-Trigger zum Greifen von Blöcken</li>
                        <li><strong>Desktop:</strong> Mausklick zum Auswählen</li>
                        <li><strong>Mobil:</strong> Touch-Gesten</li>
                    </ul>
                </div>
                <div class="concept-info">
                    <h4>Programmier-Konzepte:</h4>
                    <ul>
                        <li><strong>Variablen:</strong> Speichern Werte</li>
                        <li><strong>Funktionen:</strong> Führen Aktionen aus</li>
                        <li><strong>Schleifen:</strong> Wiederholen Code</li>
                        <li><strong>Bedingungen:</strong> Treffen Entscheidungen</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- VR Scene -->
    <a-scene 
        id="main-scene"
        vr-mode-ui="enabled: true"
        background="color: #0a0a0a; skyType: gradient; skyColor: #1a1a1a #0a0a0a"
        fog="type: exponential; color: #0a0a0a; density: 0.1"
        renderer="antialias: true; colorManagement: true; physicallyCorrectLights: true"
        loading-screen="backgroundColor: #0a0a0a; dotsColor: #84ACCE">

        <!-- Assets -->
        <a-assets>
            <!-- Code Block Mixins -->
            <a-mixin id="code-block-base"
                     geometry="primitive: box; width: 1.5; height: 0.8; depth: 0.3"
                     material="metalness: 0.2; roughness: 0.4"
                     class="code-block grabbable"
                     animation__hover="property: scale; to: 1.05 1.05 1.05; startEvents: mouseenter; dur: 200"
                     animation__unhover="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
            </a-mixin>

            <!-- Variable Block -->
            <a-mixin id="variable-block"
                     mixin="code-block-base"
                     material="color: #4a90e2; emissive: #1e3a5f; emissiveIntensity: 0.15">
            </a-mixin>

            <!-- Function Block -->
            <a-mixin id="function-block"
                     mixin="code-block-base"
                     material="color: #f5a623; emissive: #5c3a0d; emissiveIntensity: 0.15">
            </a-mixin>

            <!-- Loop Block -->
            <a-mixin id="loop-block"
                     mixin="code-block-base"
                     material="color: #7ed321; emissive: #2d5a0b; emissiveIntensity: 0.15">
            </a-mixin>

            <!-- Condition Block -->
            <a-mixin id="condition-block"
                     mixin="code-block-base"
                     material="color: #d0021b; emissive: #4a0108; emissiveIntensity: 0.15">
            </a-mixin>

            <!-- Workspace Platform -->
            <a-mixin id="workspace-platform"
                     geometry="primitive: box; width: 8; height: 0.2; depth: 4"
                     material="color: #2a2a2a; metalness: 0.3; roughness: 0.7"
                     class="workspace">
            </a-mixin>

            <!-- Holographic Text -->
            <a-mixin id="holo-text"
                     material="shader: flat; transparent: true; opacity: 0.9"
                     geometry="primitive: plane; width: auto; height: auto"
                     text="align: center; width: 8; wrapCount: 40">
            </a-mixin>
        </a-assets>

        <!-- Environment -->
        <!-- Main Platform -->
        <a-entity id="main-platform"
                  mixin="workspace-platform"
                  position="0 0 -4"
                  shadow="receive: true">
        </a-entity>

        <!-- Code Blocks Area -->
        <a-text value="Code-Blöcke"
                position="-6 2.5 -2"
                mixin="holo-text"
                color="#84ACCE"
                text="width: 6; font: dejavu">
        </a-text>

        <!-- Variable Blocks -->
        <a-entity id="var-block-1"
                  mixin="variable-block"
                  position="-6 1.5 -2"
                  data-block-type="variable"
                  data-block-code="let name = 'Schüler';"
                  class="grabbable code-block">
            <a-text value="let name = 'Schüler'"
                    position="0 0 0.2"
                    align="center"
                    width="4"
                    color="white"
                    text="font: dejavu">
            </a-text>
        </a-entity>

        <a-entity id="var-block-2"
                  mixin="variable-block"
                  position="-6 0.5 -2"
                  data-block-type="variable"
                  data-block-code="let zahl = 5;"
                  class="grabbable code-block">
            <a-text value="let zahl = 5"
                    position="0 0 0.2"
                    align="center"
                    width="4"
                    color="white"
                    text="font: dejavu">
            </a-text>
        </a-entity>

        <!-- Function Blocks -->
        <a-entity id="func-block-1"
                  mixin="function-block"
                  position="-6 1.5 -0.5"
                  data-block-type="function"
                  data-block-code="console.log(name);"
                  class="grabbable code-block">
            <a-text value="console.log(name)"
                    position="0 0 0.2"
                    align="center"
                    width="4"
                    color="white"
                    text="font: dejavu">
            </a-text>
        </a-entity>

        <a-entity id="func-block-2"
                  mixin="function-block"
                  position="-6 0.5 -0.5"
                  data-block-type="function"
                  data-block-code="console.log(zahl);"
                  class="grabbable code-block">
            <a-text value="console.log(zahl)"
                    position="0 0 0.2"
                    align="center"
                    width="4"
                    color="white"
                    text="font: dejavu">
            </a-text>
        </a-entity>

        <!-- Loop Blocks -->
        <a-entity id="loop-block-1"
                  mixin="loop-block"
                  position="-6 1.5 1"
                  data-block-type="loop"
                  data-block-code="for(let i = 1; i <= 3; i++) {"
                  class="grabbable code-block">
            <a-text value="for(let i = 1; i <= 3; i++)"
                    position="0 0 0.2"
                    align="center"
                    width="4"
                    color="white"
                    text="font: dejavu">
            </a-text>
        </a-entity>

        <a-entity id="loop-block-2"
                  mixin="loop-block"
                  position="-6 0.5 1"
                  data-block-type="loop"
                  data-block-code="}"
                  class="grabbable code-block">
            <a-text value="} (Schleife schließen)"
                    position="0 0 0.2"
                    align="center"
                    width="4"
                    color="white"
                    text="font: dejavu; width: 3">
            </a-text>
        </a-entity>

        <!-- Condition Blocks -->
        <a-entity id="condition-block-1"
                  mixin="condition-block"
                  position="-6 1.5 2.5"
                  data-block-type="condition"
                  data-block-code="if(zahl > 3) {"
                  class="grabbable code-block">
            <a-text value="if(zahl > 3)"
                    position="0 0 0.2"
                    align="center"
                    width="4"
                    color="white"
                    text="font: dejavu">
            </a-text>
        </a-entity>

        <a-entity id="condition-block-2"
                  mixin="condition-block"
                  position="-6 0.5 2.5"
                  data-block-type="condition"
                  data-block-code="}"
                  class="grabbable code-block">
            <a-text value="} (Bedingung schließen)"
                    position="0 0 0.2"
                    align="center"
                    width="4"
                    color="white"
                    text="font: dejavu; width: 3">
            </a-text>
        </a-entity>

        <!-- Workspace Area -->
        <a-text value="Arbeitsbereich"
                position="2 2.5 -4"
                mixin="holo-text"
                color="#84ACCE"
                text="width: 6; font: dejavu">
        </a-text>

        <!-- Workspace Grid Lines -->
        <a-entity id="workspace-grid">
            <!-- Horizontal Lines -->
            <a-entity geometry="primitive: plane; width: 6; height: 0.02"
                      material="color: #374151; transparent: true; opacity: 0.6"
                      position="2 1.5 -4"></a-entity>
            <a-entity geometry="primitive: plane; width: 6; height: 0.02"
                      material="color: #374151; transparent: true; opacity: 0.6"
                      position="2 1.0 -4"></a-entity>
            <a-entity geometry="primitive: plane; width: 6; height: 0.02"
                      material="color: #374151; transparent: true; opacity: 0.6"
                      position="2 0.5 -4"></a-entity>
        </a-entity>

        <!-- Robot Character (Modern Design) -->
        <a-entity id="robot-teacher"
                  position="5 1 -3">
            <!-- Robot Body -->
            <a-box width="0.8" height="1.2" depth=" 0.6"
                   color="#374151"
                   material="metalness: 0.7; roughness: 0.3">
            </a-box>
            <!-- Robot Head -->
            <a-sphere radius="0.4"
                      position="0 0.8 0"
                      color="#4b5563"
                      material="metalness: 0.7; roughness: 0.3">
            </a-sphere>
            <!-- Robot Eyes -->
            <a-sphere radius="0.06"
                      position="-0.15 0.85 0.35"
                      color="#84ACCE"
                      material="emissive: #84ACCE; emissiveIntensity: 0.8">
            </a-sphere>
            <a-sphere radius="0.06"
                      position="0.15 0.85 0.35"
                      color="#84ACCE"
                      material="emissive: #84ACCE; emissiveIntensity: 0.8">
            </a-sphere>
            
            <!-- Speech Bubble -->
            <a-text id="robot-speech"
                    value="Hallo! Ich bin CodeBot. Klicke auf Code-Blöcke um sie zu verwenden!"
                    position="0 1.8 0"
                    align="center"
                    width="4"
                    color="#1a1a1a"
                    geometry="primitive: plane; width: 3.5; height: 1.2"
                    material="color: #e5e5e5; transparent: true; opacity: 0.95"
                    text="font: dejavu">
            </a-text>
            
            <!-- Idle Animation -->
            <a-animation attribute="rotation"
                         to="0 5 0"
                         dur="4000"
                         direction="alternate"
                         repeat="indefinite"
                         easing="easeInOutSine">
            </a-animation>
        </a-entity>

        <!-- Lighting (Modern Setup) -->
        <a-light type="ambient" 
                 color="#1a1a1a" 
                 intensity="0.4">
        </a-light>
        
        <a-light type="directional"
                 position="4 8 4"
                 color="#ffffff"
                 intensity="1.0"
                 shadow="cast: true; mapSize: 2048; cameraLeft: -10; cameraRight: 10; cameraTop: 10; cameraBottom: -10">
        </a-light>
        
        <a-light type="point"
                 position="0 4 -4"
                 color="#84ACCE"
                 intensity="0.6">
        </a-light>
        
        <a-light type="point"
                 position="-6 2 -2"
                 color="#4a90e2"
                 intensity="0.3">
        </a-light>

        <!-- VR Controllers -->
        <a-entity id="left-controller"
                  laser-controls="hand: left"
                  raycaster="objects: .grabbable; lineColor: #84ACCE; lineOpacity: 0.8"
                  line="color: #84ACCE; opacity: 0.8"
                  grab-system="hand: left">
        </a-entity>

        <a-entity id="right-controller"
                  laser-controls="hand: right"
                  raycaster="objects: .grabbable; lineColor: #84ACCE; lineOpacity: 0.8"
                  line="color: #84ACCE; opacity: 0.8"
                  grab-system="hand: right">
        </a-entity>

        <!-- Desktop Camera -->
        <a-camera id="camera"
                  look-controls="pointerLockEnabled: false"
                  wasd-controls="acceleration: 20; fly: true"
                  position="0 2 2"
                  cursor="rayOrigin: mouse; fuse: false"
                  raycaster="objects: .grabbable">
            <a-cursor geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                      material="color: #84ACCE; shader: flat; opacity: 0.9">
            </a-cursor>
        </a-camera>

        <!-- Particle Systems for Effects -->
        <a-entity id="success-particles" visible="false"></a-entity>
        <a-entity id="error-particles" visible="false"></a-entity>

    </a-scene>

    <!-- External JavaScript -->
    <script src="game-logic.js"></script>
    <script src="simple-interactions.js"></script>
    <script src="ui-controller.js"></script>
    
    <!-- Initialize Lucide Icons -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
        });
    </script>
</body>
</html>